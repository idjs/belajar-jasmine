<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <!-- Standard Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width" />

    <!-- Site Properities -->
    <title>Eksplorasi Jasmine | Belajar Jasmine</title>
    <meta name="description" content="Agar tidur kita bisa lebih nyenyak" />
    <meta name="keywords" content="javascript, jasmine, unit test" />

    <!-- DocPad Meta -->
    <meta name="generator" content="DocPad v6.53.4" />

    <!-- DocPad Styles + Our Own -->
    <link  rel="stylesheet" href="/assets/monokai.css" /><link  rel="stylesheet" href="/assets/style.css" />

    <link rel="stylesheet" href="http://yui.yahooapis.com/combo?pure/0.3.0/base-min.css&pure/0.3.0/grids-min.css&pure/0.3.0/buttons-min.css&pure/0.3.0/menus-min.css">
</head>
<body>
    <a href="https://github.com/you"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <!-- A wrapper for all the blog posts -->
            <hgroup class="brand-left">
                <h1 class="brand-title">Belajar Jasmine</h1>
                <p class="brand-tagline">Agar tidur kita bisa lebih nyenyak</p>
            </hgroup>
            <nav class="nav">
                <ul class="nav-list">
                    
                    <li class="nav-item">
                        <a href="/posts/1-Pengantar.html" class="item">Pengantar</a>        
                    </li>
                    
                    <li class="nav-item">
                        <a href="/posts/2-Persiapan.html" class="item">Persiapan</a>        
                    </li>
                    
                    <li class="nav-item">
                        <a href="/posts/3-Pengantarfungsi.html" class="item">Eksplorasi Jasmine</a>        
                    </li>
                    
                    <li class="nav-item">
                        <a href="/posts/4-Matamata.html" class="item">Mata mata</a>        
                    </li>
                    
                    <li class="nav-item">
                        <a href="/posts/5-Async.html" class="item">Pengujian Asynchronous</a>        
                    </li>
                    
                    <li class="nav-item">
                        <a href="/posts/6-Plugin.html" class="item">Jasmine Plugin</a>        
                    </li>
                    
                </ul>
            </nav>
        </div>

        <div class="pure-u-1">
            <div class="content">
                <h2>Eksplorasi fungsi-fungsi Jasmine</h2>
<p>Mari kita jalankan <strong>testem</strong> dengan mengetikkan perintah di bawah ini pada console:</p>
<pre class="highlighted"><code class="http"><span class="attribute">testem</code></pre>
<p>Karena kami telah menetapkan bahwa kami ingin menguji kode kami pada browser Firefox, maka <strong>testem</strong> secara otomatis akan menjalankan Firefox. Hasilnya adalah sebagai berikut:</p>
<p><img src="/pics/testem-firefox.jpeg" alt=""></p>
<p>Kita belum menuliskan kode apapun. Sehingga belum ada kode yang dapat dites. Mari kita tuliskan test pertama kita. Buatlah sebuah berkas pada alamat <code>code/specs/vector2dSpec.js</code>. Pada berkas tersebut, mari kita tuliskan kode test pertama kita.</p>
<pre class="highlighted"><code class="javascript">    describe(<span class="string">"Vector2d"</span>, <span class="keyword">function</span>(){
        it(<span class="string">"Should have an add property"</span>, <span class="keyword">function</span>(){
            expect(vector2d.add).toBeDefined();
        });
    });</code></pre>
<p>Jadi, <code>describe</code> menunjukkan sebuah <strong>test suite</strong>. <strong>Test Suite</strong> ini semacam kelompok besar dari sebuah test. Jadi, pada contoh di atas, kita memiliki sebuah <strong>test suite</strong> mengenai module <code>Vector2d</code>. Kita bisa menentukan nama lain dari <strong>test suite</strong> tersebut. Misalnya:</p>
<pre class="highlighted"><code class="javascript">    describe(<span class="string">"Uji coba Vector2d"</span>, <span class="keyword">function</span>(){

    });</code></pre>
<p>Di dalam sebuah <strong>test suite</strong>, kita memiliki <strong>specs</strong>. Disinilah kode testing kita tuliskan. Pada contoh di atas, kita memiliki sebuah <strong>specs</strong>, dimana kita mengharapkan bahwa sebuah objek <code>vector2d</code> memiliki sebuah properti <code>add</code>. Bila kita menyimpan kode di atas, maka tampilan dari browser kita sudah berubah:</p>
<p><img src="/pics/testem-ontest.jpeg" alt=""></p>
<p>Mari kita lihat peringatannya:</p>
<pre class="highlighted"><code class="ruby"><span class="constant">ReferenceError</span><span class="symbol">:</span> vector2d is <span class="keyword">not</span> <span class="keyword">defined</span> <span class="keyword">in</span> <span class="symbol">http:</span>/<span class="regexp">/localhost:7357/specs</span><span class="regexp">/vector2dSpec.js (line 3)</code></pre>
<p>Jasmine memberitahukan kepada kita bahwa objek vector2d belum terdefinisikan. Ini sudah jelas, kita belum menuliskan kode vector2d yang hendak kita test. Ayo kita tulis module tersebut. Kita simpan module vector2d pada alamat <code>code/src/vector2d.js</code>:</p>
<pre class="highlighted"><code class="lisp">    <span class="list">(<span class="title">function</span><span class="body"><span class="list">(<span class="title">global</span><span class="body">)</span></span>{
        var vector<span class="number">2</span>d = {

        }<span class="comment">;</span>

        global.vector<span class="number">2</span>d = vector<span class="number">2</span>d<span class="comment">;</span>
    }<span class="list">(<span class="title">window</span><span class="body">)</span></span>)</span></span><span class="comment">;</span></code></pre>
<p>Pada code di atas, kita memperkenalkan objek vector2d pada <strong>global objek</strong>. Pendekatan ini hanyalah contoh. Pada project sebenarnya, bisa jadi kita menggunakan suatu <strong>namespace</strong> tertentu, ataupun menggunakan mekanisme module lainnya. Tetapi pada contoh ini, tujuan utamanya adalah bagaimana agar objek <code>vector2d</code> dapat dikenali oleh kode test kita.</p>
<p>Ketika kita menyimpan kode di atas, maka tampilan browser akan berubah. Kita memperoleh pesan error baru:</p>
<pre class="highlighted"><code class="nginx"><span class="title">Expected</span> undefined to be defined.</code></pre>
<p>Mari kita bandingkan pesan error di atas dengan kode test kita:</p>
<pre class="highlighted"><code class="erlang"><span class="function"><span class="title">expect</span><span class="params">(vector2d.add)</span>.<span class="title">toBeDefined</span><span class="params">()</span>;</code></pre>
<p>Hampir mirip bukan? Namun kode test di atas membangkitkan error karena <code>vector2d.add</code> belum terdefinisikan. Oleh jamine, <code>vector2d.add</code> bernilai <code>undefined</code>. Padahal kita menginginkan <code>vector2d.add</code> sudah terdefinisikan.</p>
<p>Ayo kita tambahkan properti add pada objek <code>vector2d</code>:</p>
<pre class="highlighted"><code class="javascript">    (<span class="keyword">function</span>(global){
        <span class="keyword">var</span> vector2d = {
            add: <span class="string">""</span>
        };

        global.vector2d = vector2d;
    }(window));</code></pre>
<p>Ketika kode di atas kita simpan, kita memperoleh tanda bahwa kode module <code>vector2d</code> sudah lolos uji coba:</p>
<p><img src="/pics/testem-passed.jpeg" alt=""></p>
<p>Sekarang mari kita buat kode test baru. Seiring kita membuat test, kita juga akan menambahkan kode pada module <code>vector2d</code> kita.</p>
<p>Misalnya kita ingin memeriksa bahwa <code>add</code> pada <code>vector2d</code> adalah sebuah <code>function</code>. Maka, kode testnya adalah sebagai berikut:</p>
<pre class="highlighted"><code class="javascript">    describe(<span class="string">"Vector2d"</span>, <span class="keyword">function</span>(){
        it(<span class="string">"Should have an add property"</span>, <span class="keyword">function</span>(){
            expect(vector2d.add).toBeDefined();
        });

        it(<span class="string">"Should have an add property which has the typeof function"</span>, <span class="keyword">function</span>(){
            expect(<span class="keyword">typeof</span> vector2d.add).toEqual(<span class="string">"function"</span>);
        });
    });</code></pre>
<p>Dan ketika kita simpan kode di atas, kita akan memperoleh tanda merah:</p>
<p><img src="/pics/testem-expected-function.jpeg" alt=""></p>
<p>Ok, masalahnya adalah, properti <code>add</code> pada objek <code>vector2d</code> adalah sebuah string, bukan fungsi. Jadi jelaslah jasmine membangkitkan kode di atas. Mari kita perbaiki module <code>vector2d</code> kita:</p>
<pre class="highlighted"><code class="javascript">    (<span class="keyword">function</span>(global){
        <span class="keyword">var</span> vector2d = {
            add: <span class="keyword">function</span>(){

            }
        };

        global.vector2d = vector2d;
    }(window));</code></pre>
<p>Dan ketika kita simpan, warna hijau muncul kembali. :D</p>
<p><img src="/pics/testem-typeof-function.jpeg" alt=""></p>
<p>Ok, pada titik ini, kita sudah berkenalan dengan lima kata kunci pada Jasmine, yaitu <code>describe</code>, <code>it</code>, <code>expect</code>, <code>toBeDefined</code>, dan <code>toBe</code>. Jasmine masih menyediakan banyak fungsi lainnya yang bertujuan untuk memudahkan penulisan kode test kita.</p>
<p>Sekarang saatnya kita menguji apakah <code>vector2d.add()</code> akan mengembalikan jawaban sesaui dengan harapan kita. Bila kita menambahkan dua buah vektor, <code>v1</code> dan <code>v2</code>, dimana pada tiap vektor, terdapat properti <code>x</code> dan <code>y</code>, maka kita juga mengharapkan metode <code>vector2d.add()</code> mengembalikan jawaban berupa sebuah objek dengan properti <code>x</code> dan <code>y</code> pula.</p>
<p>Jadi, misal:</p>
<pre class="highlighted"><code class="javascript">    <span class="keyword">var</span> v1 = {
            x: <span class="number">20</span>,
            y: <span class="number">30</span>
        },
        v2 = {
            x: <span class="number">5</span>,
            y: <span class="number">1</span>
        };</code></pre>
<p>Maka, bila kedua objek di atas dijumlahkan, seharusnya hasilnya adalah sebuah objek dengan properti <code>x</code> bernilai <code>25</code>, dan <code>y</code> bernilai <code>31</code>.</p>
<p>Untuk memastikan hal tersebut, mari kita buat testnya terlebih dahulu. Kita akan melakukannya secara bertahap. Pertama, kita periksa bahwa nilai yang dikembalikan oleh metode <code>add</code> memiliki properti <code>x</code> dan <code>y</code>:</p>
<pre class="highlighted"><code class="javascript">    it(<span class="string">"Add method should return an object with property x and y"</span>, <span class="keyword">function</span>(){
        <span class="keyword">var</span> v1 = { x: <span class="number">20</span>, y: <span class="number">30</span>},
            v2 = { x: <span class="number">5</span>, y: <span class="number">1</span>};

        expect(vector2d.add(v1, v2).hasOwnProperty(<span class="string">"x"</span>)).toBeTruthy();
    });</code></pre>
<p>Apa yang terjadi ketika kita menyimpan kode test di atas?</p>
<p><img src="/pics/testme-add-return.jpeg" alt=""></p>
<p>Ok, kita memang belum mengembalikan apapun ketika metode <code>add</code> dijalankan (perhatikan <strong>TypeError: vector2d.add(...) is undefined</strong>). Mari kita buat kode secukupnya agar kode test kita berwarna hijau:</p>
<pre class="highlighted"><code class="javascript">    <span class="keyword">var</span> vector2d = {
        add: <span class="keyword">function</span>(){
            <span class="keyword">return</span> {x: <span class="number">0</span>, y: <span class="number">0</span>};
        }
    };</code></pre>
<p>Hasilnya? Hijau.</p>
<p><img src="/pics/testme-add-return-passed.jpeg" alt=""></p>
<p>Sekarang saatnya memeriksa apakah kembalian dari metode <code>add</code> bernilai benar.</p>
<pre class="highlighted"><code class="javascript">    it(<span class="string">"Add method should return the correct answer"</span>, <span class="keyword">function</span>(){
        <span class="keyword">var</span> v1 = { x: <span class="number">20</span>, y: <span class="number">30</span>},
            v2 = { x: <span class="number">5</span>, y: <span class="number">1</span>};

        expect(vector2d.add(v1, v2)).toEqual({x: <span class="number">25</span>, y: <span class="number">31</span>});
    });</code></pre>
<p>Namun, kode test di atas akan menghasilkan:</p>
<p><img src="/pics/testme-add-return-value-failed.jpeg" alt=""></p>
<p>Perhatikan bagaimana jasmine memberitahukan kepada kita, kesalahan yang berhasil ditangkap oleh kode test terhadap module <code>vector2d</code>. Ketika kita mengharapkan kembalian berupa <code>{x: 25, y: 31}</code>, metode <code>add</code> malah mengembalikan <code>{x: 0, y: 0}</code>. Jelas bukan pesan errornya?</p>
<p>Saatnya memperbaiki metode <code>add</code>:</p>
<pre class="highlighted"><code class="javascript">    <span class="keyword">var</span> vector2d = {
        add: <span class="keyword">function</span>(v1, v2){
            <span class="keyword">return</span> {x: v1.x + v2.x , y: v1.y + v2.y};
        }
    };</code></pre>
<p>Dan, yap, hasilnya hijau:</p>
<p><img src="/pics/testme-add-return-value-passed.jpeg" alt=""></p>
<p>Ok, sampai disini semoga kita dapat melihat bagaiman <strong>testem</strong> telah memudahkan kita dalam menggunakan jasmine. Kita dapat memperoleh hasil dari testing secara langsung dan otomatis tiap kali kode kita mengalami perubahan.</p>
<p>Jangan lupa juga, bahwa <strong>testem</strong> juga melaporkan progress test kita pada console dimana command <strong>testem</strong> dijalankan:</p>
<p><img src="/pics/testem-test-progress-4tests.jpeg" alt=""></p>
<h3>Menstrukturkan Test Suite</h3>
<p>Kita dapat terus melanjutkan untuk menambahkan <strong>specs</strong> pada test kita sebelumnya. Namun ada suatu pendekatan yang dapat memudahkan kita dalam hal penstrukturan test.</p>
<p>Misal, pada kode test yang sudah ada saat ini, kita mengetahui bahwa kita sedang melakukan pengujian terhadap metode <code>add</code> yang dimiliki oleh <code>vector2d</code>. Bagaimana kalau kita mengelompokkan seluruh pengujian terhadap <code>add</code> di dalam sebuah kelompok sendiri?</p>
<p>Caranya adalah dengan menggunakan <code>describe</code>:</p>
<pre class="highlighted"><code class="javascript">    describe(<span class="string">"Vector2d"</span>, <span class="keyword">function</span>(){
        describe(<span class="string">"Add method"</span>, <span class="keyword">function</span>(){
            it(<span class="string">"Should have an add property"</span>, <span class="keyword">function</span>(){
                expect(vector2d.add).toBeDefined();
            });

            it(<span class="string">"Should have an add property which has the typeof function"</span>, <span class="keyword">function</span>(){
                expect(<span class="keyword">typeof</span> vector2d.add).toEqual(<span class="string">"function"</span>);
            });

            it(<span class="string">"Add method should return an object with property x and y"</span>, <span class="keyword">function</span>(){
                <span class="keyword">var</span> v1 = { x: <span class="number">20</span>, y: <span class="number">30</span>},
                    v2 = { x: <span class="number">5</span>, y: <span class="number">1</span>};

                expect(vector2d.add(v1, v2).hasOwnProperty(<span class="string">"x"</span>)).toBeTruthy();
            });

            it(<span class="string">"Add method should return the correct answer"</span>, <span class="keyword">function</span>(){
                <span class="keyword">var</span> v1 = { x: <span class="number">20</span>, y: <span class="number">30</span>},
                    v2 = { x: <span class="number">5</span>, y: <span class="number">1</span>};

                expect(vector2d.add(v1, v2)).toEqual({x: <span class="number">25</span>, y: <span class="number">31</span>});
            });
        });
    });</code></pre>
<p>Tampilan jasmine kita juga mengalami perubahan:</p>
<p><img src="/pics/testem-group.jpeg" alt=""></p>
<h3>Matchers Lainnya</h3>
<p>Metode seperti <code>toEqual</code>, <code>toBeDefined</code>, <code>toBeTruthy</code> yang sudah kami perlihatkan di atas adalah contoh dari <strong>matchers</strong>. Jasmine memiliki <strong>matchers</strong> lainnya yang dapat digunakan untuk menguji kode yang kita tulis.</p>
<p>Beberepa <strong>matcher</strong> lain yang disediakan oleh Jasmine adalah sebagai berikut:</p>
<p><strong>toBe</strong></p>
<pre class="highlighted"><code class="javascript">    expect(<span class="literal">true</span>).toBe(<span class="literal">true</span>);
    expect(<span class="literal">false</span>).not.toBe(<span class="literal">true</span>);</code></pre>
<p><strong>toMatch</strong> : pemeriksaan berdasarkan Regular Expression</p>
<pre class="highlighted"><code class="javascript">    expect(someString).toMatch(<span class="regexp">/foo/</span>);
    expect(someString).not.toMatch(<span class="regexp">/baar/</span>);</code></pre>
<p><strong>toBeNull</strong></p>
<pre class="highlighted"><code class="javascript">    expect(<span class="literal">null</span>).toBeNull();</code></pre>
<p><strong>toContain</strong></p>
<pre class="highlighted"><code class="javascript">    <span class="keyword">var</span> kota = [<span class="string">"Surabaya"</span>, <span class="string">"Malang"</span>, <span class="string">"Jakarta"</span>];

    expect(kota).toContain(<span class="string">"Malang"</span>);
    expect(kota).not.toContain(<span class="string">"Bandung"</span>);</code></pre>
<h3>beforeEach dan afterEach</h3>
<p>Bila kita ingin menjalankan suatu metode atau langkah-langkah tertentu sebelum setiap <strong>spec</strong> dijalankan, kita dapat memanfaatkan <code>beforeEach</code>. Sementara itu, bila kita ingin menjalankan suatu langkah tertentu setelah tiap <strong>specs</strong> selesai dijalankan, kita dapat menggunakan <code>afterEach</code>. Contoh:</p>
<pre class="highlighted"><code class="javascript">    describe(<span class="string">"Substract method"</span>, <span class="keyword">function</span>(){
        <span class="keyword">var</span> v1, v2;

        beforeEach(<span class="keyword">function</span>(){
            v1 = {x: <span class="number">20</span>, y: <span class="number">30</span>};
            v2 = {x: <span class="number">5</span>, y: <span class="number">50</span>};
        });

        afterEach(<span class="keyword">function</span>(){
            v1 = v2 = <span class="literal">null</span>;
        });

        it(<span class="string">"Should substract properly"</span>, <span class="keyword">function</span>(){
            expect(vector2d.substract(v1, v2)).toEqual({x: <span class="number">15</span>, y: -<span class="number">20</span>});
        });

        it(<span class="string">"Should only have x and y as direct properties"</span>, <span class="keyword">function</span>(){
            <span class="keyword">var</span> result = vector2d.substract(v1, v2);

            <span class="comment">// memeriksa sesuatu bernilai undefined</span>
            expect(result.a).toBeUndefined();

            <span class="comment">// berikut ini sama saja dengan bentuk di atas</span>
            expect(result.a).not.toBeDefined();
        });

        it(<span class="string">"Should have no problem working with PI"</span>, <span class="keyword">function</span>(){
            <span class="keyword">var</span> test = {x: <span class="number">5</span>, y: Math.PI}, <span class="comment">// Math.PI = 3.14.... sekian sekian</span>
                result = vector2d.substract(v1, test);

            expect(result.y).toBeGreaterThan(<span class="number">26</span>); <span class="comment">// lebih besar dari 26</span>
            expect(result.y).toBeLessThan(<span class="number">27</span>); <span class="comment">// kurang dari 27</span>

            expect(result.y).toBeCloseTo(<span class="number">26.85</span>, <span class="number">1</span>);
        });
    });</code></pre>
<p>Pada contoh di atas, sebelum tiap <strong>spec</strong> dijalankan, kita memberikan nilai kepada variabel <code>v1</code> dan <code>v2</code>. Tiap kali <strong>specs</strong> dijalankan, <code>v1</code> dan <code>v2</code> bernilai sesuai dengan nilai yang diberikan ketika <code>beforeEach</code> dijalankan.</p>
<p>Ketika tiap <strong>specs</strong> sudah dijalankan, kita me-null-kan kembali <code>v1</code> dan <code>v2</code>.</p>

            </div>
        </div>
    </div>
</body>
</html>