<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Mata mata</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link  rel="stylesheet" href="/assets/style.css" /><link  rel="stylesheet" href="/assets/monokai.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/0.3.4/css/semantic.min.css">
</head>
<body>

<div class="ui red vertical sidebar menu" style="display:block;margin-left: 0!important;">

    <div class="item">
        <h2>Belajar Jasmine</h2>
        <div class="menu">
            
                <a href="/posts/1-Pengantar.html" class="item">Pengantar</a>
            
                <a href="/posts/2-Persiapan.html" class="item">Persiapan</a>
            
                <a href="/posts/3-Pengantarfungsi.html" class="item">Eksplorasi Jasmine</a>
            
                <a href="/posts/4-Matamata.html" class="item">Mata mata</a>
            
                <a href="/posts/5-Async.html" class="item">Pengujian Asynchronous</a>
            
                <a href="/posts/6-Plugin.html" class="item">Jasmine Plugin</a>
            
        </div>
    </div>

</div>

<div id="content">
    <h2>Mata-mata</h2>
<p>Mari kita membuat module untuk menghitung ukuran(magnitude) dari vector. Rumusnya adalah sebagai berikut:</p>
<pre class="highlighted"><code class="matlab"><span class="function"><span class="keyword">function</span> <span class="title">mag</span><span class="params">( v )</span> {</span>
    <span class="keyword">return</span> <span class="transposed_variable">Math.</span><span class="built_in">sqrt</span>(<span class="transposed_variable">v.</span>x * <span class="transposed_variable">v.</span>x + <span class="transposed_variable">v.</span>y * <span class="transposed_variable">v.</span>y);
}</code></pre>
<p>Ternyata, bagian <code>v.x * v.x + v.y * v.y</code> di atas dapat digunakan juga untuk menghitung <em>dot product</em> secara cepat dari 2 buat vector:</p>
<pre class="highlighted"><code class="matlab"><span class="function"><span class="keyword">function</span> <span class="title">dot</span><span class="params">( v1, v2 )</span> {</span>
    <span class="keyword">return</span> <span class="transposed_variable">v1.</span>x * <span class="transposed_variable">v2.</span>x + <span class="transposed_variable">v1.</span>y * <span class="transposed_variable">v2.</span>y;
}</code></pre>
<p>Bagaimana bila kita manfaatkan metode <code>dot</code> di atas ketika kita hendak menghitung magnitude dari sebuah vector?</p>
<pre class="highlighted"><code class="avrasm">var vector2d = {
    <span class="keyword">add</span>: function( v1, v2 ){
        return {<span class="built_in">x</span>: v1<span class="preprocessor">.x</span> + v2<span class="preprocessor">.x</span> , <span class="built_in">y</span>: v1<span class="preprocessor">.y</span> + v2<span class="preprocessor">.y</span>}<span class="comment">;</span>
    },

    substract: function( v1, v2 ){
        return {<span class="built_in">x</span>: v1<span class="preprocessor">.x</span> - v2<span class="preprocessor">.x</span> , <span class="built_in">y</span>: v1<span class="preprocessor">.y</span> - v2<span class="preprocessor">.y</span>}<span class="comment">;</span>
    },

    dot: function( v1, v2 ) {
        return v1<span class="preprocessor">.x</span> * v2<span class="preprocessor">.x</span> + v1<span class="preprocessor">.y</span> * v2<span class="preprocessor">.y</span><span class="comment">;</span>
    },

    mag: function( v ) {
        return Math<span class="preprocessor">.sqrt</span>(this<span class="preprocessor">.dot</span>(v, v))<span class="comment">;</span>
    }
}<span class="comment">;</span></code></pre>
<p>Mari kita buat test awal:</p>
<pre class="highlighted"><code class="erlang"><span class="function"><span class="title">describe</span><span class="params">(<span class="string">"Norm method"</span>, <span class="keyword">fun</span><span class="function_name">ction</span>() <span class="tuple">{

    var v1, v2;

    <span class="function_name">it</span>(<span class="string">"Should calculate the magnitude properly"</span>, <span class="keyword">fun</span><span class="function_name">ction</span>() <span class="tuple">{
        var result = vector2d.<span class="function_name">mag</span>(<span class="tuple">{x: <span class="number">3</span>, y: -<span class="number">4</span>}</span>);
        <span class="function_name">expect</span>(result).<span class="function_name">toEqual</span>(<span class="number">5</span>);
    }</span>);
});</code></pre>
<p>Ok, sesuai dengan yang kita inginkan. Tetapi bagaimana bila kita ingin memeriksa bahwa fungsi <code>mag</code> memanggil fungsi <code>dot</code> dengan parameter yang benar? Disinilah saatnya kita menggunakan <strong>Spies</strong> atau mata-mata.</p>
<p>Dengan <strong>Spies</strong> Kita dapat memantau bagaiman suatu fungsi dipanggil. Pada contoh berikut, kita memantau interaksi antara metode <code>mag</code> dengan metode <code>dot</code>.</p>
<pre class="highlighted"><code class="avrasm">    it(<span class="string">"Should call dot method"</span>, function() {
        // memasang mata-mata pada metode dot
        spyOn(vector2d, <span class="string">"dot"</span>)<span class="comment">;</span>

        // jalankan metode mag
        vector2d<span class="preprocessor">.mag</span>(v)<span class="comment">;</span>

        // memastikan bahwa metode dot benar dijalankan
        expect(vector2d<span class="preprocessor">.dot</span>)<span class="preprocessor">.toHaveBeenCalled</span>()<span class="comment">;</span>
    })<span class="comment">;</span>

    it(<span class="string">"Should call dot method with the correct params"</span>, function() {
        // memasang mata-mata pada metode dot
        spyOn(vector2d, <span class="string">"dot"</span>)<span class="comment">;</span>

        // jalankan metode mag
        vector2d<span class="preprocessor">.mag</span>(v)<span class="comment">;</span>

        // memastikan bahwa metode dot dipanggil dengan parameter
        // vector yang benar
        expect(vector2d<span class="preprocessor">.dot</span>)<span class="preprocessor">.toHaveBeenCalledWith</span>({<span class="built_in">x</span>: <span class="number">3</span>,<span class="built_in">y</span>: -<span class="number">4</span>}, {<span class="built_in">x</span>: <span class="number">3</span>,<span class="built_in">y</span>: -<span class="number">4</span>})<span class="comment">;</span>
    })<span class="comment">;</span>

    it(<span class="string">"Should track the number of calls to dot"</span>, function() {
        // memasang mata-mata pada metode dot
        spyOn(vector2d, <span class="string">"dot"</span>)<span class="comment">;</span>

        // jalankan metode mag <span class="number">3</span> kali
        vector2d<span class="preprocessor">.mag</span>(v)<span class="comment">;</span>
        vector2d<span class="preprocessor">.mag</span>(v)<span class="comment">;</span>
        vector2d<span class="preprocessor">.mag</span>(v)<span class="comment">;</span>

        // memastikan bahwa metode dot dipanggil <span class="number">3</span> kali juga
        expect(vector2d<span class="preprocessor">.dot</span><span class="preprocessor">.calls</span><span class="preprocessor">.length</span>)<span class="preprocessor">.toEqual</span>(<span class="number">3</span>)<span class="comment">;</span>
    })<span class="comment">;</span></code></pre>

</div>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/0.3.4/javascript/semantic.min.js"></script>

<script defer="defer"  src="/scripts/script.js"></script>
</body>
</html>